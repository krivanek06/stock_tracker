<div class="grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
	<!-- portfolio state -->
	<app-portfolio-state
		[portfolioCash]="user?.portfolio?.portfolioCash"
		[portfolioInvested]="portfolioInvested"
		portfolioState="PARTIAL"
	></app-portfolio-state>

	<!-- bid / ask -->
	<app-trading-bid-ask
		*ngIf="selectedSummary?.marketPrice as marketPrice"
		class="hidden lg:table-cell"
		[bidPrice]="marketPrice - 0.03"
		[askPrice]="marketPrice + 0.03"
	>
	</app-trading-bid-ask>

	<!-- portfolio chart -->
	<div class="hidden xs:flex -mt-4 md:-mt-8 justify-center">
		<app-pie-chart-wrapper
			*ngIf="user?.portfolio as portfolio"
			[heightPx]="280"
			chartTitle="Portfolio allocation"
			[data]="[
					{name: 'Invested', color: '#5e00df', y: 100 / (portfolioInvested + portfolio.portfolioCash) * portfolioInvested, sliced: true},
					{name: 'Cash', color: '#c7481a', y: 100 / (portfolioInvested + portfolio.portfolioCash) * portfolio.portfolioCash}
				]"
		></app-pie-chart-wrapper>
	</div>
</div>

<!-- search symbol -->
<div>
	<app-stock-search (clickedSymbolEmitter)="loadSummary($event)" [clearOnClick]="true"> </app-stock-search>
</div>

<!-- chart -->
<app-loader-wrapper>
	<ng-container *ngIf="selectedSummary">
		<div class="grid grid-cols-1 lg:grid-cols-3 gap-2">
			<!-- financial chart -->
			<app-financial-chart-container
				class="col-span-1"
				[ngClass]="{
					'lg:col-span-3': !isStock,
					'lg:col-span-2': isStock
				}"
				[closedPrice]="selectedSummary.previousClose"
				[currentPrice]="selectedSummary.marketPrice"
				[height]="460"
				[logoUrl]="selectedSummary.logo_url"
				[name]="selectedSummary.companyName"
				[symbol]="selectedSummary.symbol"
			>
			</app-financial-chart-container>

			<!-- summary -->
			<app-mat-card-wrapper *ngIf="isStock" additionalClasses="st-height-100">
				<app-details-stock-summary [summary]="selectedSummary"></app-details-stock-summary>
			</app-mat-card-wrapper>
		</div>

		<!-- buttons -->
		<div class="p-2 flex flex-col md:flex-row justify-end gap-2">
			<button mat-flat-button *ngIf="isStock" color="primary" class="w-full md:w-auto min-w-[120px]" (click)="showDetails()">Details</button>
			<button mat-flat-button class="g-button-warning w-full md:w-auto min-w-[120px]" (click)="tradeSymbol()">Trade</button>
		</div>
	</ng-container>
</app-loader-wrapper>

<!-- holdings -->
<div class="flex gap-2 mb-2 mt-6">
	<mat-icon color="primary">book</mat-icon>
	<span class="text-xl g-color-white">Holdings</span>
	<span class="text-xl text-gray-500">[{{clonedHoldings.length}}/45] </span>
</div>
<app-mat-card-wrapper>
	<app-holdings-table
		(itemClickedEmitter)="changeSymbol($event)"
		[holdings]="clonedHoldings"
		[totalPortfolio]="(user?.portfolio?.portfolioCash || 0) + portfolioInvested"
	>
	</app-holdings-table>
</app-mat-card-wrapper>

<!-- suggestion -->
<div class="text-xl g-color-white mb-2 mt-6">Suggestions</div>
<div class="grid grid-cols-1 xs:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
	<app-mat-card-wrapper *ngFor="let suggestion of suggestions" (click)="changeSummary(suggestion.summary)" [clickable]="true">
		<app-details-stock-suggestion-change [suggestionMarketPrice]="suggestion.summary.marketPrice" [suggestion]="suggestion">
		</app-details-stock-suggestion-change>
	</app-mat-card-wrapper>
</div>
