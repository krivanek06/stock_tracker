<ion-toolbar class="ion-hide-sm-up">
	<ion-buttons slot="end">
		<ion-button (click)="dismiss()" color="danger">
			<ion-icon name="close-outline"></ion-icon>
			Close
		</ion-button>
	</ion-buttons>
</ion-toolbar>

<div class="st-flex-col ion-align-items-center">
	<!-- text -->
	<div class="p-4">
		<div class="text-lg text-center">
			<span class="st-price-up st-font-size-18">Buy</span>
			or
			<span class="st-price-down st-font-size-18">Sell</span>
		</div>
		<div class="text-lg">operation on {{ data.symbol }} stock</div>
	</div>

	<!-- bid / ask -->
	<div class="st-width-100">
		<app-trading-bid-ask [bidPrice]="data.price - data.price * 0.005" [askPrice]="data.price + data.price * 0.005"></app-trading-bid-ask>
	</div>

	<!-- estimated price -->
	<div class="ion-padding st-flex-col">
		<ion-text class="st-font-1 st-font-size-16">Estimated price / share: {{ data.price | currency }}</ion-text>
		<div class="st-flex-col st-top-space">
			<ion-text *ngIf="data.holding" class="st-font-2 st-font-size-16">
				Owned: {{ ( data.holding.units * data.holding.breakEvenPrice) | currency }} ({{data.holding.breakEvenPrice | currency}} * {{
				data.holding.units }})
			</ion-text>
			<ion-text class="st-font-2 st-font-size-16 ion-text-center">Cash: {{ data.portoflioCash | currency }}</ion-text>
		</div>
	</div>

	<form [formGroup]="form">
		<!-- amount -->
		<app-form-mat-input-wrapper inputCaption="Number of units" controlName="units" inputType="NUMBER"></app-form-mat-input-wrapper>

		<div class="flex justify-end mb-4 gap-4">
			<ion-item>
				<ion-label color="accent">Buy all</ion-label>
				<ion-checkbox class="ion-margin-end" formControlName="buyAll" slot="start"></ion-checkbox>
			</ion-item>
			<ion-item>
				<ion-label color="warn">Sell all</ion-label>
				<ion-checkbox class="ion-margin-end" formControlName="sellAll" slot="start" [disabled]="!data.holding"></ion-checkbox>
			</ion-item>
		</div>

		<div class="flex justify-between items-center">
			<!-- estimated price -->
			<ion-item>
				<ion-label>
					<ion-text>Total price: {{ (data.price * units.value) | currency }}</ion-text>
				</ion-label>
			</ion-item>

			<!-- confirm -->
			<ion-item>
				<ion-label>Confirm</ion-label>
				<ion-checkbox class="ion-margin-end" formControlName="confirmation" slot="start"></ion-checkbox>
			</ion-item>
		</div>

		<!-- fees -->
		<ion-item>
			<ion-label class="st-font-5"> Fees: {{ (data.price * 0.0025 * units.value) | currency }} (0.25% from price) </ion-label>
		</ion-item>

		<!-- buttons -->
		<ion-buttons>
			<ion-button
				class="st-button"
				(click)="submit(STTransactionOperationEnum.Buy)"
				[disabled]="form.invalid || sellAll.value || !hasEnoughCashToBuy"
				fill="outline"
				color="success"
				shape="round"
				fill="solid"
			>
				Buy
			</ion-button>
			<ion-button
				class="st-button"
				(click)="submit(STTransactionOperationEnum.Sell)"
				[disabled]="form.invalid || buyAll.value || !canSellSoManyUnits"
				fill="outline"
				color="danger"
				shape="round"
				fill="solid"
			>
				Sell
			</ion-button>
		</ion-buttons>
	</form>
</div>
