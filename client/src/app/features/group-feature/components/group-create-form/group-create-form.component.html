<form [formGroup]="form" (ngSubmit)="submit()">
	<div class="flex flex-col md:flex-row gap-4 justify-center">
		<app-uploader
			#uploader
			[maxHeight]="250"
			[maxWidth]="315"
			[filePath]="'groups'"
			[defaultUrl]="imageUrl.value"
			(uploadedFilesEmitter)="uploadedGroupImage($event)"
		>
		</app-uploader>

		<div class="flex flex-col flex-1">
			<!-- Group name -->
			<app-form-mat-input-wrapper class="w-full" inputCaption="Group name" controlName="name"> </app-form-mat-input-wrapper>

			<!-- Description -->
			<app-form-mat-input-wrapper
				class="w-full"
				inputCaption="Group description"
				inputType="TEXTAREA"
				controlName="description"
				hintText="Add description for your group, this step is optional"
			>
			</app-form-mat-input-wrapper>
		</div>
	</div>

	<div class="flex flex-col gap-4 md:flex-row mt-6">
		<!-- Private -->
		<app-form-mat-input-wrapper
			class="flex-1"
			inputCaption="Private"
			inputType="CHECKBOX"
			controlName="isPrivate"
			hintText="Check if you want to make your group private, which means users can join only if they receive an invitation, otherwise group is open for everybody to send an invitations"
		>
		</app-form-mat-input-wrapper>

		<!-- Infinite -->
		<app-form-mat-input-wrapper
			class="flex-1"
			inputCaption="Infinite"
			inputType="CHECKBOX"
			controlName="isInfinite"
			hintText="If checked the group will never be closed automatically. If uncheck, then please select a specific date as a group expiration date"
		>
		</app-form-mat-input-wrapper>

		<!-- Infinite -->
		<app-form-mat-input-wrapper
			class="flex-1"
			inputCaption="Add me as member"
			inputType="CHECKBOX"
			controlName="isOwnerAlsoMember"
			hintText="Check if you, as a group owner, want to be also as a member. If checked, the group statistics will be affected by your progress"
		>
		</app-form-mat-input-wrapper>
	</div>

	<div class="flex flex-col md:flex-row gap-4 mt-6">
		<!-- Start date -->
		<app-form-mat-input-wrapper
			class="flex-1"
			inputCaption="Start date"
			inputType="DATEPICKER"
			controlName="startDate"
			hintText="Select a date when the group will officially start, since which date the progress of the group will be monitored"
			[inputTypeDateTimePickerConfig]="inputTypeDateTimePickerConfig"
		>
		</app-form-mat-input-wrapper>

		<!-- End date -->
		<app-form-mat-input-wrapper
			class="flex-1"
			inputCaption="End date"
			inputType="DATEPICKER"
			controlName="endDate"
			[inputTypeDateTimePickerConfig]="inputTypeDateTimePickerConfig"
			[disabled]="isInfinite.value"
			[hintText]="isInfinite.value ? '' : 'Select a date when the group performance monitoring should end. After this date a group report will be generated how well the group performed' "
		>
		</app-form-mat-input-wrapper>
	</div>

	<!-- Errors -->
	<ion-toolbar *ngIf="showError || dateStartError || dateEndError" class="st-error-message">
		<ng-container *ngIf="showError">Please fill all required information about creating a group</ng-container>
		<ng-container *ngIf="dateStartError">Starting date cannot be before today</ng-container>
		<ng-container *ngIf="dateEndError">Ending date cannot be before starting date</ng-container>
	</ion-toolbar>

	<!-- submit button -->
	<div class="mt-4 flex justify-end">
		<button
			mat-flat-button
			color="primary"
			class="w-full md:w-auto"
			[disabled]="showError || dateStartError || dateEndError || invitationSent.length > 40"
		>
			{{ editedGroup ? 'Edit group' : 'Create group' }}
		</button>
	</div>

	<div *ngIf="!editedGroup" class="mt-4">
		<!-- invite members input -->
		<ion-toolbar class="st-title"> Search users which you want to invite </ion-toolbar>
		<app-user-account-search (clickedUserEmitter)="sendInvitation($event)"> </app-user-account-search>

		<!-- listed users -->
		<ion-toolbar class="ion-margin-top st-title"> Send invitation: {{ invitationSent.length }} / 40</ion-toolbar>
		<div class="w-full p-4 bg-slate-600 g-color-white text-center text-base rounded-lg">
			The maximum number of members in one group can be 40 people
		</div>
		<ion-item-group class="st-flex-wrap-normal">
			<app-user-account-info-list
				*ngFor="let user of invitationSent"
				(deleteEmitter)="invitationRemove(user)"
				[showDeleteButton]="true"
				[clickable]="false"
				[stUserPublicData]="user"
			>
			</app-user-account-info-list>
		</ion-item-group>
	</div>
</form>
